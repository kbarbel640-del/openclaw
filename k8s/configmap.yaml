apiVersion: v1
kind: ConfigMap
metadata:
  name: clawdbot-config
  namespace: clawdbot
data:
  # Gateway configuration
  CLAWDBOT_GATEWAY_PORT: "18789"
  CLAWDBOT_BRIDGE_PORT: "18790"
  CLAWDBOT_GATEWAY_BIND: "0.0.0.0" # Bind to all interfaces in container
  NODE_ENV: "production"
  TERM: "xterm-256color"

  # Clawdbot config file (clawdbot.json)
  clawdbot.json: |
    {
      "gateway": {
        "mode": "local",
        "port": 18789,
        "auth": {
          "mode": "token"
        }
      },
      "agents": {
        "defaults": {
          "workspace": "/home/node/clawd",
          "model": {
            "primary": "genai-vnpay/v_air45"
          },
          "models": {
            "anthropic/claude-opus-4-5": { "alias": "Claude" },
            "genai-vnpay/v_air45": { "alias": "VNPAY" }
          }
        }
      },
      "channels": {
        "whatsapp": {
          "dmPolicy": "pairing",
          "allowFrom": []
        },
        "zalo": {
          "enabled": true,
          "dmPolicy": "allowlist",
          "allowFrom": ["0fc808c0d7893ed76798","0b59340e0d46e418bd57"],
          "mediaMaxMb": 5
        }
      },
      "plugins": {
        "paths": ["/app/extensions/zalo"]
      },
      "logging": {
        "level": "info",
        "consoleLevel": "info",
        "consoleStyle": "pretty"
      },
      "models": {
        "mode": "merge",
        "providers": {
          "genai-vnpay": {
            "baseUrl": "https://genai.vnpay.vn/aigateway/llm_glm_air/v1",
            "apiKey": "${GENAI_VNPAY_API_KEY}",
            "api": "openai-completions",
            "models": [
              {
                "id": "v_air45",
                "name": "GenAI VNPAY Air 45",
                "reasoning": false,
                "input": ["text"],
                "contextWindow": 128000,
                "maxTokens": 30000,
                "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }
              }
            ]
          }
        }
      }
    }
