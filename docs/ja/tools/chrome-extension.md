---
summary: "Chrome 拡張機能: OpenClaw に既存の Chrome タブを操作させる"
read_when:
  - エージェントに既存の Chrome タブ（ツールバーボタン）を操作させたい場合
  - リモートの Gateway（ゲートウェイ）+ Tailscale 経由のローカルブラウザー自動化が必要な場合
  - ブラウザー乗っ取りのセキュリティ上の影響を理解したい場合
title: "Chrome 拡張機能"
x-i18n:
  source_path: tools/chrome-extension.md
  source_hash: 3b77bdad7d3dab6a
  provider: openai
  model: gpt-5.2-pro
  workflow: v1
  generated_at: 2026-02-06T05:12:32Z
---

# Chrome 拡張機能（ブラウザーリレー）

OpenClaw Chrome 拡張機能を使うと、エージェントは別の openclaw 管理の Chrome プロファイルを起動する代わりに、**既存の Chrome タブ**（通常の Chrome ウィンドウ）を制御できます。

アタッチ/デタッチは **Chrome ツールバーの単一ボタン**で行えます。

## それは何か（概念）

3 つのパートがあります:

- **ブラウザー制御サービス**（Gateway（ゲートウェイ）またはノード）: エージェント/ツールが（Gateway（ゲートウェイ）経由で）呼び出す API
- **ローカルリレーサーバー**（loopback CDP）: 制御サーバーと拡張機能の間をブリッジします（デフォルトは `http://127.0.0.1:18792`）
- **Chrome MV3 拡張機能**: `chrome.debugger` を使ってアクティブなタブにアタッチし、CDP メッセージをリレーへ中継します

その後 OpenClaw は、通常の `browser` ツールの操作面（正しいプロファイルを選択）を通じて、アタッチされたタブを制御します。

## インストール / 読み込み（アンパック）

1. 拡張機能を安定したローカルパスにインストールします:

```bash
openclaw browser extension install
```

2. インストールされた拡張機能ディレクトリのパスを表示します:

```bash
openclaw browser extension path
```

3. Chrome → `chrome://extensions`

- 「Developer mode」を有効にします
- 「Load unpacked」→ 上で表示されたディレクトリを選択します

4. 拡張機能をピン留めします。

## アップデート（ビルド手順なし）

拡張機能は、OpenClaw リリース（npm パッケージ）内に静的ファイルとして同梱されています。別途「ビルド」手順はありません。

OpenClaw をアップグレードした後:

- `openclaw browser extension install` を再実行して、OpenClaw の状態ディレクトリ配下にあるインストール済みファイルを更新します。
- Chrome → `chrome://extensions` → 拡張機能の「Reload」をクリックします。

## 使い方（追加設定なし）

OpenClaw には、デフォルトポート上の拡張機能リレーを対象とする `chrome` という組み込みブラウザープロファイルが同梱されています。

使い方:

- CLI: `openclaw browser --browser-profile chrome tabs`
- エージェントツール: `browser` を `profile="chrome"` とともに使用します

別の名前や別のリレーポートを使いたい場合は、独自のプロファイルを作成してください:

```bash
openclaw browser create-profile \
  --name my-chrome \
  --driver extension \
  --cdp-url http://127.0.0.1:18792 \
  --color "#00AA00"
```

## アタッチ / デタッチ（ツールバーボタン）

- OpenClaw に制御させたいタブを開きます。
- 拡張機能アイコンをクリックします。
  - バッジはアタッチ時に `ON` を表示します。
- もう一度クリックするとデタッチします。

## どのタブを制御しますか？

- 「いま見ているタブ」を自動的に制御することは **ありません**。
- ツールバーボタンをクリックして明示的にアタッチした **タブのみ**を制御します。
- 切り替えるには: 別のタブを開き、そのタブで拡張機能アイコンをクリックします。

## バッジ + よくあるエラー

- `ON`: アタッチ済み。OpenClaw がそのタブを操作できます。
- `…`: ローカルリレーに接続中です。
- `!`: リレーに到達できません（最も一般的: このマシンでブラウザーリレーサーバーが動作していません）。

`!` が表示される場合:

- Gateway（ゲートウェイ）がローカルで動作している（デフォルト構成）ことを確認するか、Gateway（ゲートウェイ）が別の場所で動作している場合はこのマシンでノードホストを実行してください。
- 拡張機能の Options ページを開いてください。リレーに到達できるかどうかが表示されます。

## リモート Gateway（ゲートウェイ）（ノードホストを使用）

### ローカル Gateway（ゲートウェイ）（Chrome と同じマシン）— 通常は **追加手順なし**

Gateway（ゲートウェイ）が Chrome と同じマシンで動作している場合、loopback 上でブラウザー制御サービスを開始し、
リレーサーバーを自動起動します。拡張機能はローカルリレーと通信し、CLI/ツールの呼び出しは Gateway（ゲートウェイ）へ送られます。

### リモート Gateway（ゲートウェイ）（Gateway（ゲートウェイ）が別マシン）— **ノードホストを実行**

Gateway（ゲートウェイ）が別のマシンで動作している場合は、Chrome が動作しているマシンでノードホストを起動してください。
Gateway（ゲートウェイ）はブラウザー操作をそのノードへプロキシし、拡張機能 + リレーはブラウザーマシンのローカルに留まります。

複数ノードが接続されている場合は、`gateway.nodes.browser.node` で 1 台に固定するか、`gateway.nodes.browser.mode` を設定してください。

## サンドボックス化（ツールコンテナ）

エージェントセッションがサンドボックス化されている場合（`agents.defaults.sandbox.mode != "off"`）、`browser` ツールは制限されることがあります:

- デフォルトでは、サンドボックス化されたセッションはホストの Chrome ではなく **サンドボックスブラウザー**（`target="sandbox"`）を対象にすることがよくあります。
- Chrome 拡張機能リレーの乗っ取りには、**ホスト**のブラウザー制御サーバーを制御する必要があります。

選択肢:

- 最も簡単: **サンドボックス化されていない**セッション/エージェントから拡張機能を使います。
- または、サンドボックス化されたセッションに対してホストのブラウザー制御を許可します:

```json5
{
  agents: {
    defaults: {
      sandbox: {
        browser: {
          allowHostControl: true,
        },
      },
    },
  },
}
```

その後、ツールがツールポリシーで拒否されていないことを確認し、（必要であれば）`browser` を `target="host"` とともに呼び出してください。

デバッグ: `openclaw sandbox explain`

## リモートアクセスのヒント

- Gateway（ゲートウェイ）とノードホストは同じ tailnet に維持し、リレーポートを LAN やパブリックインターネットへ公開しないようにしてください。
- ノードは意図してペアリングし、リモート制御を望まない場合はブラウザープロキシルーティングを無効にしてください（`gateway.nodes.browser.mode="off"`）。

## 「extension path」の動作

`openclaw browser extension path` は、拡張機能ファイルを含む **インストール済み**のディスク上ディレクトリを出力します。

CLI は意図的に `node_modules` パスを出力しません。常に先に `openclaw browser extension install` を実行して、拡張機能を OpenClaw の状態ディレクトリ配下の安定した場所へコピーしてください。

そのインストールディレクトリを移動または削除すると、有効なパスから再読み込みするまで、Chrome は拡張機能を壊れているものとしてマークします。

## セキュリティ上の影響（必ずお読みください）

これは強力で、リスクもあります。モデルに「ブラウザーを直接操作する手」を与えるものとして扱ってください。

- 拡張機能は Chrome の debugger API（`chrome.debugger`）を使用します。アタッチされている間、モデルは次を行えます:
  - そのタブでクリック/入力/ナビゲートする
  - ページ内容を読む
  - タブのログイン済みセッションがアクセスできるものすべてにアクセスする
- 専用の openclaw 管理プロファイルのように **分離されていません**。
  - 日常利用のプロファイル/タブにアタッチすると、そのアカウント状態へのアクセスを付与することになります。

推奨事項:

- 拡張機能リレー用途には、個人のブラウジングとは分離した専用の Chrome プロファイルを優先してください。
- Gateway（ゲートウェイ）とノードホストは tailnet のみに保ち、Gateway（ゲートウェイ）の認証 + ノードのペアリングに依存してください。
- LAN（`0.0.0.0`）経由でリレーポートを公開しないようにし、Funnel（パブリック）も避けてください。
- リレーは拡張機能以外のオリジンをブロックし、CDP クライアントに内部認証トークンを要求します。

関連:

- ブラウザーツール概要: [Browser](/tools/browser)
- セキュリティ監査: [Security](/gateway/security)
- Tailscale 設定: [Tailscale](/gateway/tailscale)
