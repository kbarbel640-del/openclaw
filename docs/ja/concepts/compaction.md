---
summary: "コンテキストウィンドウ + 圧縮：OpenClaw がセッションをモデルの上限内に保つ方法"
read_when:
  - 自動圧縮と /compact について理解したい場合
  - コンテキスト上限に達して長くなったセッションをデバッグしている場合
title: "圧縮"
x-i18n:
  source_path: concepts/compaction.md
  source_hash: e1d6791f2902044b
  provider: openai
  model: gpt-5.2-pro
  workflow: v1
  generated_at: 2026-02-06T05:02:49Z
---

# コンテキストウィンドウ & 圧縮

各モデルには **コンテキストウィンドウ**（参照できる最大トークン数）があります。長時間のチャットではメッセージやツール結果が蓄積し、ウィンドウが逼迫すると、OpenClaw は上限内に収めるために古い履歴を **圧縮** します。

## 圧縮とは

圧縮は、**古い会話を要約** してコンパクトな要約エントリにまとめ、直近のメッセージはそのまま保持します。要約はセッション履歴に保存されるため、以後のリクエストでは次が使用されます。

- 圧縮の要約
- 圧縮ポイント以降の直近メッセージ

圧縮はセッションの JSONL 履歴に **永続化** されます。

## 設定

`agents.defaults.compaction` の設定については、[圧縮の設定とモード](/concepts/compaction) を参照してください。

## 自動圧縮（デフォルトでオン）

セッションがモデルのコンテキストウィンドウに近づく、または超えると、OpenClaw は自動圧縮をトリガーし、圧縮されたコンテキストを使って元のリクエストを再試行することがあります。

次が表示されます。

- verbose モードでの `🧹 Auto-compaction complete`
- `🧹 Compactions: <count>` を示す `/status`

圧縮の前に、OpenClaw は **サイレントメモリフラッシュ** のターンを実行して、永続的なメモをディスクへ保存できます。詳細と設定は [Memory](/concepts/memory) を参照してください。

## 手動圧縮

`/compact`（任意で指示を付与）を使って、圧縮パスを強制的に実行します。

```
/compact Focus on decisions and open questions
```

## コンテキストウィンドウの参照元

コンテキストウィンドウはモデル固有です。OpenClaw は、設定されたプロバイダーカタログのモデル定義を使用して上限を判定します。

## 圧縮とプルーニングの違い

- **圧縮**：要約し、JSONL に **永続化** します。
- **セッションのプルーニング**：古い **ツール結果** のみをリクエストごとに **メモリ内** でトリミングします。

プルーニングの詳細は [/concepts/session-pruning](/concepts/session-pruning) を参照してください。

## ヒント

- セッションが古く感じる、またはコンテキストが肥大化している場合は `/compact` を使用します。
- 大きなツール出力はすでに切り詰められていますが、プルーニングによりツール結果の蓄積をさらに減らせます。
- まっさらな状態が必要な場合は、`/new` または `/reset` で新しいセッション id を開始します。
