# OpenClaw 위협 모델 v1.0

## MITRE ATLAS 프레임워크

**버전:** 1.0-초안
**최종 업데이트:** 2026-02-04
**방법론:** MITRE ATLAS + 데이터 흐름 다이어그램
**프레임워크:** [MITRE ATLAS](https://atlas.mitre.org/) (AI 시스템을 위한 적대적 위협 환경)

### 프레임워크 속성

이 위협 모델은 AI/ML 시스템에 대한 적대적 위협을 문서화하기 위한 업계 표준 프레임워크인 [MITRE ATLAS](https://atlas.mitre.org/)를 기반으로 구축되었습니다. ATLAS는 AI 보안 커뮤니티와 협력하여 [MITRE](https://www.mitre.org/)에 의해 유지 관리됩니다.

**주요 ATLAS 리소스:**

- [ATLAS 기술](https://atlas.mitre.org/techniques/)
- [ATLAS 전술](https://atlas.mitre.org/tactics/)
- [ATLAS 사례 연구](https://atlas.mitre.org/studies/)
- [ATLAS GitHub](https://github.com/mitre-atlas/atlas-data)
- [ATLAS에 기여](https://atlas.mitre.org/resources/contribute)

### 이 위협 모델에 기여

이는 OpenClaw 커뮤니티에서 유지 관리하는 살아있는 문서입니다. 기여에 대한 지침은 [CONTRIBUTING-THREAT-MODEL.md](./CONTRIBUTING-THREAT-MODEL.md)를 참조하세요.

- 새로운 위협 보고
- 기존 위협 업데이트
- 공격 체인 제안
- 완화 제안

---

## 1. 소개

### 1.1 목적

이 위협 모델은 AI/ML 시스템용으로 특별히 설계된 MITRE ATLAS 프레임워크를 사용하여 OpenClaw AI 에이전트 플랫폼 및 ClawHub 기술 시장에 대한 적대적 위협을 문서화합니다.

### 1.2 범위

| 구성요소                 | 포함됨 | 메모                                          |
| ------------------------ | ------ | --------------------------------------------- |
| OpenClaw 에이전트 런타임 | 예     | 핵심 에이전트 실행, 도구 호출, 세션           |
| 게이트웨이               | 예     | 인증, 라우팅, 채널 통합                       |
| 채널 통합                | 예     | WhatsApp, 텔레그램, 디스코드, 시그널, 슬랙 등 |
| ClawHub 마켓플레이스     | 예     | 기술 게시, 조정, 배포                         |
| MCP 서버                 | 예     | 외부 도구 제공업체                            |
| 사용자 장치              | 부분   | 모바일 앱, 데스크톱 클라이언트                |

### 1.3 범위 외

이 위협 모델의 범위를 명시적으로 벗어나는 것은 없습니다.

---

## 2. 시스템 아키텍처

### 2.1 신뢰 경계

```
┌─────────────────────────────────────────────────────────────────┐
│                    UNTRUSTED ZONE                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  WhatsApp   │  │  Telegram   │  │   Discord   │  ...         │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │
│         │                │                │                      │
└─────────┼────────────────┼────────────────┼──────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 1: Channel Access                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      GATEWAY                              │   │
│  │  • Device Pairing (30s grace period)                      │   │
│  │  • AllowFrom / AllowList validation                       │   │
│  │  • Token/Password/Tailscale auth                          │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 2: Session Isolation              │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   AGENT SESSIONS                          │   │
│  │  • Session key = agent:channel:peer                       │   │
│  │  • Tool policies per agent                                │   │
│  │  • Transcript logging                                     │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 3: Tool Execution                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                  EXECUTION SANDBOX                        │   │
│  │  • Docker sandbox OR Host (exec-approvals)                │   │
│  │  • Node remote execution                                  │   │
│  │  • SSRF protection (DNS pinning + IP blocking)            │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 4: External Content               │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              FETCHED URLs / EMAILS / WEBHOOKS             │   │
│  │  • External content wrapping (XML tags)                   │   │
│  │  • Security notice injection                              │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 5: Supply Chain                   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      CLAWHUB                              │   │
│  │  • Skill publishing (semver, SKILL.md required)           │   │
│  │  • Pattern-based moderation flags                         │   │
│  │  • VirusTotal scanning (coming soon)                      │   │
│  │  • GitHub account age verification                        │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 데이터 흐름

| 흐름 | 소스       | 목적지     | 데이터          | 보호           |
| ---- | ---------- | ---------- | --------------- | -------------- |
| F1   | 채널       | 게이트웨이 | 사용자 메시지   | TLS, AllowFrom |
| F2   | 게이트웨이 | 에이전트   | 라우팅된 메시지 | 세션 격리      |
| F3   | 에이전트   | 도구       | 도구 호출       | 정책 시행      |
| F4   | 에이전트   | 외부       | web_fetch 요청  | SSRF 차단      |
| F5   | 클로허브   | 에이전트   | 스킬 코드       | 중재, 스캔     |
| F6   | 에이전트   | 채널       | 응답            | 출력 필터링    |

---

## 3. ATLAS Tactic을 통한 위협 분석

### 3.1 정찰(AML.TA0002)

#### T-RECON-001: 에이전트 엔드포인트 검색

| 속성                     | 가치                                                         |
| ------------------------ | ------------------------------------------------------------ |
| **아틀라스 ID**          | AML.T0006 - 활성 검색                                        |
| **설명**                 | 공격자는 노출된 OpenClaw 게이트웨이 엔드포인트를 검색합니다. |
| **공격 벡터**            | 네트워크 스캐닝, 쇼단 쿼리, DNS 열거                         |
| **영향을 받는 구성요소** | 게이트웨이, 노출된 API 엔드포인트                            |
| **현재 완화 조치**       | Tailscale 인증 옵션, 기본적으로 루프백에 바인딩              |
| **잔존 위험**            | 중간 - 공용 게이트웨이 검색 가능                             |
| **권장사항**             | 보안 배포 문서화, 검색 엔드포인트에 속도 제한 추가           |

#### T-RECON-002: 채널 통합 조사

| 속성                     | 가치                                                           |
| ------------------------ | -------------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0006 - 활성 검색                                          |
| **설명**                 | 공격자는 AI 관리 계정을 식별하기 위해 메시징 채널을 조사합니다 |
| **공격 벡터**            | 테스트 메시지 보내기, 응답 패턴 관찰                           |
| **영향을 받는 구성요소** | 모든 채널 통합                                                 |
| **현재 완화 조치**       | 구체적인 내용 없음                                             |
| **잔존 위험**            | 낮음 - 발견만으로는 가치가 제한됨                              |
| **권장사항**             | 응답 타이밍 무작위화 고려                                      |

---

### 3.2 초기 액세스(AML.TA0004)

#### T-ACCESS-001: 페어링 코드 차단

| 속성                     | 가치                                                  |
| ------------------------ | ----------------------------------------------------- |
| **아틀라스 ID**          | AML.T0040 - AI 모델 추론 API 액세스                   |
| **설명**                 | 공격자는 30초 유예 기간 동안 페어링 코드를 가로챕니다 |
| **공격 벡터**            | 숄더 서핑, 네트워크 스니핑, 소셜 엔지니어링           |
| **영향을 받는 구성요소** | 장치 페어링 시스템                                    |
| **현재 완화 조치**       | 30초 만료, 기존 채널을 통해 코드 전송                 |
| **잔존 위험**            | 중간 - 유예 기간 이용 가능                            |
| **권장사항**             | 유예기간 단축, 확인 단계 추가                         |

#### T-ACCESS-002: 스푸핑 허용

| 속성                     | 가치                                                    |
| ------------------------ | ------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0040 - AI 모델 추론 API 액세스                     |
| **설명**                 | 공격자가 채널에서 허용된 보낸 사람 신원을 스푸핑        |
| **공격 벡터**            | 채널에 따라 다름 - 전화번호 스푸핑, 사용자 이름 사칭    |
| **영향을 받는 구성요소** | 채널당 AllowFrom 검증                                   |
| **현재 완화 조치**       | 채널별 본인확인                                         |
| **잔존 위험**            | 중간 - 스푸핑에 취약한 일부 채널                        |
| **권장사항**             | 채널별 위험을 문서화하고 가능한 경우 암호화 확인을 추가 |

#### T-ACCESS-003: 토큰 도난

| 속성                     | 가치                                        |
| ------------------------ | ------------------------------------------- |
| **아틀라스 ID**          | AML.T0040 - AI 모델 추론 API 액세스         |
| **설명**                 | 공격자가 구성 파일에서 인증 토큰을 훔칩니다 |
| **공격 벡터**            | 악성 코드, 무단 장치 액세스, 구성 백업 노출 |
| **영향을 받는 구성요소** | ~/.openclaw/credentials/, 구성 저장소       |
| **현재 완화 조치**       | 파일 권한                                   |
| **잔존 위험**            | 높음 - 일반 텍스트로 저장된 토큰            |
| **권장사항**             | 저장 중인 토큰 암호화 구현, 토큰 순환 추가  |

---

### 3.3 실행(AML.TA0005)

#### T-EXEC-001: 직접 프롬프트 주입

| 속성                     | 가치                                                               |
| ------------------------ | ------------------------------------------------------------------ |
| **아틀라스 ID**          | AML.T0051.000 - LLM 프롬프트 삽입: 직접                            |
| **설명**                 | 공격자는 에이전트 동작을 조작하기 위해 조작된 프롬프트를 보냅니다. |
| **공격 벡터**            | 적대적 지시가 포함된 채널 메시지                                   |
| **영향을 받는 구성요소** | 에이전트 LLM, 모든 입력 표면                                       |
| **현재 완화 조치**       | 패턴 감지, 외부 콘텐츠 래핑                                        |
| **잔존 위험**            | 심각 - 탐지만 가능, 차단 없음. 정교한 공격 우회                    |
| **권장사항**             | 민감한 작업에 대한 다계층 방어, 출력 검증, 사용자 확인 구현        |

#### T-EXEC-002: 간접 프롬프트 삽입

| 속성                     | 가치                                       |
| ------------------------ | ------------------------------------------ |
| **아틀라스 ID**          | AML.T0051.001 - LLM 프롬프트 삽입: 간접    |
| **설명**                 | 공격자가 가져온 콘텐츠에 악성 명령을 삽입  |
| **공격 벡터**            | 악성 URL, 감염된 이메일, 손상된 웹훅       |
| **영향을 받는 구성요소** | web_fetch, 이메일 수집, 외부 데이터 소스   |
| **현재 완화 조치**       | XML 태그 및 보안 공지를 사용한 콘텐츠 래핑 |
| **잔존 위험**            | 높음 - LLM이 래퍼 지침을 무시할 수 있음    |
| **권장사항**             | 콘텐츠 삭제, 별도의 실행 컨텍스트 구현     |

#### T-EXEC-003: 도구 인수 삽입

| 속성                     | 가치                                             |
| ------------------------ | ------------------------------------------------ |
| **아틀라스 ID**          | AML.T0051.000 - LLM 프롬프트 삽입: 직접          |
| **설명**                 | 공격자는 프롬프트 삽입을 통해 도구 인수를 조작   |
| **공격 벡터**            | 도구 매개변수 값에 영향을 미치는 작성된 프롬프트 |
| **영향을 받는 구성요소** | 모든 도구 호출                                   |
| **현재 완화 조치**       | 위험한 명령에 대한 Exec 승인                     |
| **잔존 위험**            | 높음 - 사용자 판단에 의존                        |
| **권장사항**             | 인수 검증, 매개변수화된 도구 호출 구현           |

#### T-EXEC-004: Exec 승인 우회

| 속성                     | 가치                                           |
| ------------------------ | ---------------------------------------------- |
| **아틀라스 ID**          | AML.T0043 - 적대적 데이터 제작                 |
| **설명**                 | 공격자가 승인 허용 목록을 우회하는 명령을 작성 |
| **공격 벡터**            | 명령 난독화, 별칭 악용, 경로 조작              |
| **영향을 받는 구성요소** | exec-approvals.ts, 명령 허용 목록              |
| **현재 완화 조치**       | 허용 목록 + 요청 모드                          |
| **잔존 위험**            | 높음 - 명령 삭제 없음                          |
| **권장사항**             | 명령 정규화 구현, 차단 목록 확장               |

---

### 3.4 지속성(AML.TA0006)

#### T-PERSIST-001: 악성 스킬 설치

| 속성                     | 가치                                                  |
| ------------------------ | ----------------------------------------------------- |
| **아틀라스 ID**          | AML.T0010.001 - 공급망 침해: AI 소프트웨어            |
| **설명**                 | 공격자가 ClawHub에 악성 스킬 공개                     |
| **공격 벡터**            | 계정생성, 숨겨진 악성코드가 담긴 스킬 공개            |
| **영향을 받는 구성요소** | ClawHub, 스킬 로딩, 에이전트 실행                     |
| **현재 완화 조치**       | GitHub 계정 연령 확인, 패턴 기반 조정 플래그          |
| **잔존 위험**            | 중요 - 샌드박싱 없음, 제한된 검토                     |
| **권장사항**             | VirusTotal 통합(진행중), 스킬 샌드박싱, 커뮤니티 리뷰 |

#### T-PERSIST-002: 스킬 업데이트 중독

| 속성                     | 가치                                                   |
| ------------------------ | ------------------------------------------------------ |
| **아틀라스 ID**          | AML.T0010.001 - 공급망 침해: AI 소프트웨어             |
| **설명**                 | 공격자는 인기 스킬을 손상시키고 악성 업데이트를 푸시   |
| **공격 벡터**            | 계정 도용, 스킬 소유자의 소셜 엔지니어링               |
| **영향을 받는 구성요소** | ClawHub 버전 관리, 자동 업데이트 흐름                  |
| **현재 완화 조치**       | 버전 핑거프린팅                                        |
| **잔존 위험**            | 높음 - 자동 업데이트로 인해 악성 버전이 발생할 수 있음 |
| **권장사항**             | 업데이트 서명, 롤백 기능, 버전 고정 구현               |

#### T-PERSIST-003: 에이전트 구성 변조

| 속성                     | 가치                                                 |
| ------------------------ | ---------------------------------------------------- |
| **아틀라스 ID**          | AML.T0010.002 - 공급망 침해: 데이터                  |
| **설명**                 | 공격자가 액세스를 유지하기 위해 에이전트 구성을 수정 |
| **공격 벡터**            | 구성 파일 수정, 설정 주입                            |
| **영향을 받는 구성요소** | 에이전트 구성, 도구 정책                             |
| **현재 완화 조치**       | 파일 권한                                            |
| **잔존 위험**            | 중간 - 로컬 액세스 필요                              |
| **권장사항**             | 구성 무결성 확인, 구성 변경에 대한 감사 로깅         |

---

### 3.5 방어 회피(AML.TA0007)

#### T-EVADE-001: 조정 패턴 우회

| 속성                     | 가치                                                        |
| ------------------------ | ----------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0043 - 적대적 데이터 제작                              |
| **설명**                 | 공격자는 조정 패턴을 회피하기 위해 기술 콘텐츠를 제작합니다 |
| **공격 벡터**            | 유니코드 동형문자, 인코딩 요령, 동적 로딩                   |
| **영향을 받는 구성요소** | ClawHub 조정.ts                                             |
| **현재 완화 조치**       | 패턴 기반 FLAG_RULES                                        |
| **잔존 위험**            | 높음 - 간단한 정규식을 쉽게 우회                            |
| **권장사항**             | 행동분석(VirusTotal Code Insight), AST 기반 탐지 추가       |

#### T-EVADE-002: 콘텐츠 래퍼 이스케이프

| 속성                     | 가치                                                       |
| ------------------------ | ---------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0043 - 적대적 데이터 제작                             |
| **설명**                 | 공격자는 XML 래퍼 컨텍스트를 벗어나는 콘텐츠를 제작합니다. |
| **공격 벡터**            | 태그 조작, 컨텍스트 혼란, 명령 무시                        |
| **영향을 받는 구성요소** | 외부 콘텐츠 래핑                                           |
| **현재 완화 조치**       | XML 태그 + 보안 공지                                       |
| **잔존 위험**            | 중간 - 정기적으로 발견되는 새로운 탈출구                   |
| **권장사항**             | 다중 래퍼 레이어, 출력측 유효성 검사                       |

---

### 3.6 검색(AML.TA0008)

#### T-DISC-001: 도구 열거

| 속성                     | 가치                                                 |
| ------------------------ | ---------------------------------------------------- |
| **아틀라스 ID**          | AML.T0040 - AI 모델 추론 API 액세스                  |
| **설명**                 | 공격자는 메시지를 통해 사용 가능한 도구를 나열합니다 |
| **공격 벡터**            | "어떤 도구가 있나요?" 스타일 쿼리                    |
| **영향을 받는 구성요소** | 에이전트 도구 레지스트리                             |
| **현재 완화 조치**       | 구체적인 내용 없음                                   |
| **잔존 위험**            | 낮음 - 일반적으로 문서화된 도구                      |
| **권장사항**             | 도구 가시성 제어 고려                                |

#### T-DISC-002: 세션 데이터 추출

| 속성                     | 가치                                                  |
| ------------------------ | ----------------------------------------------------- |
| **아틀라스 ID**          | AML.T0040 - AI 모델 추론 API 액세스                   |
| **설명**                 | 공격자는 세션 컨텍스트에서 민감한 데이터를 추출합니다 |
| **공격 벡터**            | "우리는 무엇을 논의했습니까?" 쿼리, 컨텍스트 조사     |
| **영향을 받는 구성요소** | 세션 기록, 컨텍스트 창                                |
| **현재 완화 조치**       | 발신자별 세션 격리                                    |
| **잔존 위험**            | 중간 - 세션 내 데이터에 액세스 가능                   |
| **권장사항**             | 상황에 맞게 민감한 데이터 수정 구현                   |

---

### 3.7 수집 및 유출(AML.TA0009, AML.TA0010)

#### T-EXFIL-001: web_fetch를 통한 데이터 도난

| 속성                     | 가치                                                               |
| ------------------------ | ------------------------------------------------------------------ |
| **아틀라스 ID**          | AML.T0009 - 컬렉션                                                 |
| **설명**                 | 공격자는 에이전트에게 외부 URL로 전송하도록 지시하여 데이터를 유출 |
| **공격 벡터**            | 에이전트가 공격자 서버에 데이터를 게시하도록 하는 프롬프트 삽입    |
| **영향을 받는 구성요소** | web_fetch 도구                                                     |
| **현재 완화 조치**       | 내부 네트워크에 대한 SSRF 차단                                     |
| **잔존 위험**            | 높음 - 외부 URL 허용                                               |
| **권장사항**             | URL 허용 목록 구현, 데이터 분류 인식                               |

#### T-EXFIL-002: 무단 메시지 전송

| 속성                     | 가치                                                              |
| ------------------------ | ----------------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0009 - 컬렉션                                                |
| **설명**                 | 공격자가 에이전트가 민감한 데이터가 포함된 메시지를 보내도록 유도 |
| **공격 벡터**            | 에이전트가 공격자에게 메시지를 보내게 하는 프롬프트 삽입          |
| **영향을 받는 구성요소** | 메시지 도구, 채널 통합                                            |
| **현재 완화 조치**       | 아웃바운드 메시징 게이팅                                          |
| **잔존 위험**            | 중간 - 게이팅을 우회할 수 있음                                    |
| **권장사항**             | 새 수신자에 대한 명시적인 확인 필요                               |

#### T-EXFIL-003: 자격 증명 수집

| 속성                     | 가치                                                         |
| ------------------------ | ------------------------------------------------------------ |
| **아틀라스 ID**          | AML.T0009 - 컬렉션                                           |
| **설명**                 | 악의적인 기술이 에이전트 컨텍스트에서 자격 증명을 수집합니다 |
| **공격 벡터**            | 스킬 코드는 환경 변수, 구성 파일을 읽습니다.                 |
| **영향을 받는 구성요소** | 스킬 실행 환경                                               |
| **현재 완화 조치**       | 기술에만 국한되지 않음                                       |
| **잔존 위험**            | 심각 - 상담원 권한으로 스킬이 실행됨                         |
| **권장사항**             | 기술 샌드박싱, 자격 증명 격리                                |

---

### 3.8 영향(AML.TA0011)

#### T-IMPACT-001: 무단 명령 실행

| 속성                     | 가치                                        |
| ------------------------ | ------------------------------------------- |
| **아틀라스 ID**          | AML.T0031 - AI 모델 무결성 저하             |
| **설명**                 | 공격자가 사용자 시스템에서 임의 명령을 실행 |
| **공격 벡터**            | 임원 승인 우회와 결합된 신속한 주입         |
| **영향을 받는 구성요소** | Bash 도구, 명령 실행                        |
| **현재 완화 조치**       | Exec 승인, Docker 샌드박스 옵션             |
| **잔존 위험**            | 심각 - 샌드박스 없이 호스트 실행            |
| **권장사항**             | 샌드박스 기본값, 승인 UX 개선               |

#### T-IMPACT-002: 리소스 고갈(DoS)

| 속성                     | 가치                                                |
| ------------------------ | --------------------------------------------------- |
| **아틀라스 ID**          | AML.T0031 - AI 모델 무결성 저하                     |
| **설명**                 | 공격자가 API 크레딧 또는 컴퓨팅 리소스를 소진합니다 |
| **공격 벡터**            | 자동화된 메시지 플러딩, 값비싼 도구 호출            |
| **영향을 받는 구성요소** | 게이트웨이, 에이전트 세션, API 제공자               |
| **현재 완화 조치**       | 없음                                                |
| **잔존 위험**            | 높음 - 속도 제한 없음                               |
| **권장사항**             | 발신자별 비율 제한, 비용 예산 구현                  |

#### T-IMPACT-003: 평판 손상

| 속성                     | 가치                                                           |
| ------------------------ | -------------------------------------------------------------- |
| **아틀라스 ID**          | AML.T0031 - AI 모델 무결성 저하                                |
| **설명**                 | 공격자가 에이전트가 유해하거나 공격적인 콘텐츠를 보내도록 유발 |
| **공격 벡터**            | 신속한 주입으로 부적절한 대응 발생                             |
| **영향을 받는 구성요소** | 출력 생성, 채널 메시징                                         |
| **현재 완화 조치**       | LLM 제공업체 콘텐츠 정책                                       |
| **잔존 위험**            | 중간 - 공급자 필터가 불완전함                                  |
| **권장사항**             | 출력 필터링 레이어, 사용자 컨트롤                              |

---

## 4. ClawHub 공급망 분석

### 4.1 현재 보안 통제

| 제어                  | 구현                        | 효율성                                                |
| --------------------- | --------------------------- | ----------------------------------------------------- |
| GitHub 계정 연령      | `requireGitHubAccountAge()` | 중간 - 새로운 공격자에 대한 기준을 높입니다           |
| 경로 삭제             | `sanitizePath()`            | 높음 - 경로 순회 방지                                 |
| 파일 형식 유효성 검사 | `isTextFile()`              | 중간 - 텍스트 파일만 가능하지만 여전히 악성일 수 있음 |
| 크기 제한             | 총 50MB 번들                | 높음 - 자원 고갈 방지                                 |
| 필수 SKILL.md         | 필수 읽어보기               | 낮은 보안 가치 - 정보 제공용                          |
| 패턴 조정             | moderation.ts의 FLAG_RULES  | 낮음 - 쉽게 우회됨                                    |
| 중재 상태             | `moderationStatus` 필드     | 중간 - 직접 검토 가능                                 |

### 4.2 중재 플래그 패턴

`moderation.ts`의 현재 패턴:

```javascript
// Known-bad identifiers
/(keepcold131\/ClawdAuthenticatorTool|ClawdAuthenticatorTool)/i

// Suspicious keywords
/(malware|stealer|phish|phishing|keylogger)/i
/(api[-_ ]?key|token|password|private key|secret)/i
/(wallet|seed phrase|mnemonic|crypto)/i
/(discord\.gg|webhook|hooks\.slack)/i
/(curl[^\n]+\|\s*(sh|bash))/i
/(bit\.ly|tinyurl\.com|t\.co|goo\.gl|is\.gd)/i
```

**제한사항:**

- 슬러그, 디스플레이이름, 요약, 서문, 메타데이터, 파일 경로만 확인합니다.
- 실제 스킬코드 내용을 분석하지 않습니다.
- 난독화로 쉽게 우회되는 간단한 정규식
- 행동 분석 없음

### 4.3 계획된 개선 사항

| 개선            | 상태                               | 영향                                                                |
| --------------- | ---------------------------------- | ------------------------------------------------------------------- |
| VirusTotal 통합 | 진행 중                            | High - Code Insight 행동 분석                                       |
| 커뮤니티 신고   | 부분적(`skillReports` 테이블 존재) | 중간                                                                |
| 감사 로깅       | 부분적(`auditLogs` 테이블 존재)    | 중간                                                                |
| 배지 시스템     | 구현                               | 중간 - `highlighted`, `official`, `deprecated`, `redactionApproved` |

---

## 5. 위험 매트릭스

### 5.1 가능성과 영향

| 위협 ID       | 가능성 | 영향 | 위험 수준 | 우선순위 |
| ------------- | ------ | ---- | --------- | -------- |
| T-EXEC-001    | 높음   | 심각 | **중요**  | P0       |
| T-PERSIST-001 | 높음   | 심각 | **중요**  | P0       |
| T-EXFIL-003   | 중간   | 심각 | **중요**  | P0       |
| T-IMPACT-001  | 중간   | 심각 | **높음**  | P1       |
| T-EXEC-002    | 높음   | 높음 | **높음**  | P1       |
| T-EXEC-004    | 중간   | 높음 | **높음**  | P1       |
| T-액세스-003  | 중간   | 높음 | **높음**  | P1       |
| T-EXFIL-001   | 중간   | 높음 | **높음**  | P1       |
| T-IMPACT-002  | 높음   | 중간 | **높음**  | P1       |
| T-EVADE-001   | 높음   | 중간 | **중간**  | P2       |
| T-액세스-001  | 낮음   | 높음 | **중간**  | P2       |
| T-액세스-002  | 낮음   | 높음 | **중간**  | P2       |
| T-PERSIST-002 | 낮음   | 높음 | **중간**  | P2       |

### 5.2 중요 경로 공격 체인

**공격 체인 1: 기술 기반 데이터 도난**

```
T-PERSIST-001 → T-EVADE-001 → T-EXFIL-003
(Publish malicious skill) → (Evade moderation) → (Harvest credentials)
```

**공격 체인 2: RCE에 즉각적인 주입**

```
T-EXEC-001 → T-EXEC-004 → T-IMPACT-001
(Inject prompt) → (Bypass exec approval) → (Execute commands)
```

**공격 체인 3: 가져온 콘텐츠를 통한 간접 주입**

```
T-EXEC-002 → T-EXFIL-001 → External exfiltration
(Poison URL content) → (Agent fetches & follows instructions) → (Data sent to attacker)
```

---

## 6. 권장 사항 요약

### 6.1 즉시(P0)

| 아이디 | 추천                                     | 주소                       |
| ------ | ---------------------------------------- | -------------------------- |
| R-001  | 완전한 VirusTotal 통합                   | T-PERSIST-001, T-EVADE-001 |
| R-002  | 스킬 샌드박싱 구현                       | T-PERSIST-001, T-EXFIL-003 |
| R-003  | 민감한 작업에 대한 출력 유효성 검사 추가 | T-EXEC-001, T-EXEC-002     |

### 6.2 단기(P1)

| 아이디 | 추천                                | 주소         |
| ------ | ----------------------------------- | ------------ |
| R-004  | 속도 제한 구현                      | T-IMPACT-002 |
| R-005  | 유휴 토큰 암호화 추가               | T-액세스-003 |
| R-006  | 임원 승인 UX 및 검증 개선           | T-EXEC-004   |
| R-007  | web_fetch에 대한 URL 허용 목록 구현 | T-EXFIL-001  |

### 6.3 중기(P2)

| 아이디 | 추천                                      | 주소          |
| ------ | ----------------------------------------- | ------------- |
| R-008  | 가능한 경우 암호화 채널 확인을 추가하세요 | T-액세스-002  |
| R-009  | 구성 무결성 확인 구현                     | T-PERSIST-003 |
| R-010  | 업데이트 서명 및 버전 고정 추가           | T-PERSIST-002 |

---

## 7. 부록

### 7.1 ATLAS 기술 매핑

| 아틀라스 ID   | 기술명                  | OpenClaw 위협                                                    |
| ------------- | ----------------------- | ---------------------------------------------------------------- |
| AML.T0006     | 능동 스캐닝             | T-RECON-001, T-RECON-002                                         |
| AML.T0009     | 컬렉션                  | T-EXFIL-001, T-EXFIL-002, T-EXFIL-003                            |
| AML.T0010.001 | 공급망: AI 소프트웨어   | T-PERSIST-001, T-PERSIST-002                                     |
| AML.T0010.002 | 공급망: 데이터          | T-PERSIST-003                                                    |
| AML.T0031     | AI 모델 무결성 침식     | T-IMPACT-001, T-IMPACT-002, T-IMPACT-003                         |
| AML.T0040     | AI 모델 추론 API 액세스 | T-ACCESS-001, T-ACCESS-002, T-ACCESS-003, T-DISC-001, T-DISC-002 |
| AML.T0043     | 적대적 데이터 제작      | T-EXEC-004, T-EVADE-001, T-EVADE-002                             |
| AML.T0051.000 | LLM 프롬프트 주입: 직접 | T-EXEC-001, T-EXEC-003                                           |
| AML.T0051.001 | LLM 프롬프트 주입: 간접 | T-EXEC-002                                                       |

### 7.2 주요 보안 파일

| 경로                                | 목적             | 위험 수준 |
| ----------------------------------- | ---------------- | --------- |
| `src/infra/exec-approvals.ts`       | 명령 승인 로직   | **중요**  |
| `src/gateway/auth.ts`               | 게이트웨이 인증  | **중요**  |
| `src/web/inbound/access-control.ts` | 채널 접근 제어   | **중요**  |
| `src/infra/net/ssrf.ts`             | SSRF 보호        | **중요**  |
| `src/security/external-content.ts`  | 신속한 주입 완화 | **중요**  |
| `src/agents/sandbox/tool-policy.ts` | 도구 정책 시행   | **중요**  |
| `convex/lib/moderation.ts`          | ClawHub 조정     | **높음**  |
| `convex/lib/skillPublish.ts`        | 스킬 게시 흐름   | **높음**  |
| `src/routing/resolve-route.ts`      | 세션 격리        | **중간**  |

### 7.3 용어집

| 기간            | 정의                                            |
| --------------- | ----------------------------------------------- |
| **아틀라스**    | AI 시스템을 위한 MITRE의 적대적 위협 환경       |
| **클로허브**    | OpenClaw의 기술 마켓플레이스                    |
| **게이트웨이**  | OpenClaw의 메시지 라우팅 및 인증 계층           |
| **MCP**         | 모델 컨텍스트 프로토콜 - 도구 제공자 인터페이스 |
| **신속한 주입** | 입력에 악성 명령어가 포함된 공격                |
| **스킬**        | OpenClaw 에이전트를 위한 다운로드 가능한 확장   |
| **SSRF**        | 서버측 요청 위조                                |

---

*이 위협 모델은 살아있는 문서입니다. 보안 문제를 security@openclaw.ai*로 보고하세요.
