---
summary: "Cấu hình và thiết lập bot chat Twitch"
read_when:
  - Thiết lập tích hợp chat Twitch cho OpenClaw
title: "Twitch"
x-i18n:
  source_path: channels/twitch.md
  source_hash: 0dd1c05bef570470
  provider: openai
  model: gpt-5.2-chat-latest
  workflow: v1
  generated_at: 2026-02-08T07:06:23Z
---

# Twitch (plugin)

Hỗ trợ chat Twitch thông qua kết nối IRC. OpenClaw kết nối với tư cách một người dùng Twitch (tài khoản bot) để nhận và gửi tin nhắn trong các kênh.

## Plugin bắt buộc

Twitch được phát hành dưới dạng plugin và không được gộp sẵn trong bản cài đặt lõi.

Cài đặt qua CLI (npm registry):

```bash
openclaw plugins install @openclaw/twitch
```

Checkout cục bộ (khi chạy từ repo git):

```bash
openclaw plugins install ./extensions/twitch
```

Chi tiết: [Plugins](/plugin)

## Thiết lập nhanh (người mới)

1. Tạo một tài khoản Twitch riêng cho bot (hoặc dùng tài khoản hiện có).
2. Tạo thông tin xác thực: [Twitch Token Generator](https://twitchtokengenerator.com/)
   - Chọn **Bot Token**
   - Xác minh các scope `chat:read` và `chat:write` đã được chọn
   - Sao chép **Client ID** và **Access Token**
3. Tìm Twitch user ID của bạn: https://www.streamweasels.com/tools/convert-twitch-username-to-user-id/
4. Cấu hình token:
   - Env: `OPENCLAW_TWITCH_ACCESS_TOKEN=...` (chỉ tài khoản mặc định)
   - Hoặc config: `channels.twitch.accessToken`
   - Nếu cả hai đều được đặt, config sẽ được ưu tiên (env chỉ là dự phòng cho tài khoản mặc định).
5. Khởi động Gateway.

**⚠️ Quan trọng:** Thêm kiểm soát truy cập (`allowFrom` hoặc `allowedRoles`) để ngăn người dùng trái phép kích hoạt bot. `requireMention` mặc định là `true`.

Cấu hình tối thiểu:

```json5
{
  channels: {
    twitch: {
      enabled: true,
      username: "openclaw", // Bot's Twitch account
      accessToken: "oauth:abc123...", // OAuth Access Token (or use OPENCLAW_TWITCH_ACCESS_TOKEN env var)
      clientId: "xyz789...", // Client ID from Token Generator
      channel: "vevisk", // Which Twitch channel's chat to join (required)
      allowFrom: ["123456789"], // (recommended) Your Twitch user ID only - get it from https://www.streamweasels.com/tools/convert-twitch-username-to-user-id/
    },
  },
}
```

## Nó là gì

- Một kênh Twitch do Gateway sở hữu.
- Định tuyến xác định: phản hồi luôn quay lại Twitch.
- Mỗi tài khoản ánh xạ tới một khóa phiên biệt lập `agent:<agentId>:twitch:<accountName>`.
- `username` là tài khoản bot (dùng để xác thực), `channel` là phòng chat cần tham gia.

## Thiết lập (chi tiết)

### Tạo thông tin xác thực

Dùng [Twitch Token Generator](https://twitchtokengenerator.com/):

- Chọn **Bot Token**
- Xác minh các scope `chat:read` và `chat:write` đã được chọn
- Sao chép **Client ID** và **Access Token**

Không cần đăng ký ứng dụng thủ công. Token sẽ hết hạn sau vài giờ.

### Cấu hình bot

**Biến môi trường (chỉ tài khoản mặc định):**

```bash
OPENCLAW_TWITCH_ACCESS_TOKEN=oauth:abc123...
```

**Hoặc config:**

```json5
{
  channels: {
    twitch: {
      enabled: true,
      username: "openclaw",
      accessToken: "oauth:abc123...",
      clientId: "xyz789...",
      channel: "vevisk",
    },
  },
}
```

Nếu cả env và config đều được đặt, config sẽ được ưu tiên.

### Kiểm soát truy cập (khuyến nghị)

```json5
{
  channels: {
    twitch: {
      allowFrom: ["123456789"], // (recommended) Your Twitch user ID only
    },
  },
}
```

Ưu tiên `allowFrom` cho allowlist cứng. Dùng `allowedRoles` nếu bạn muốn kiểm soát dựa trên vai trò.

**Các vai trò khả dụng:** `"moderator"`, `"owner"`, `"vip"`, `"subscriber"`, `"all"`.

**Vì sao dùng user ID?** Username có thể thay đổi, dẫn đến giả mạo. User ID là vĩnh viễn.

Tìm Twitch user ID của bạn: https://www.streamweasels.com/tools/convert-twitch-username-%20to-user-id/ (Chuyển username Twitch của bạn sang ID)

## Làm mới token (tùy chọn)

Token từ [Twitch Token Generator](https://twitchtokengenerator.com/) không thể tự động làm mới — hãy tạo lại khi hết hạn.

Để tự động làm mới token, hãy tạo ứng dụng Twitch của riêng bạn tại [Twitch Developer Console](https://dev.twitch.tv/console) và thêm vào config:

```json5
{
  channels: {
    twitch: {
      clientSecret: "your_client_secret",
      refreshToken: "your_refresh_token",
    },
  },
}
```

Bot sẽ tự động làm mới token trước khi hết hạn và ghi log các sự kiện làm mới.

## Hỗ trợ nhiều tài khoản

Dùng `channels.twitch.accounts` với token theo từng tài khoản. Xem [`gateway/configuration`](/gateway/configuration) cho mẫu dùng chung.

Ví dụ (một tài khoản bot trong hai kênh):

```json5
{
  channels: {
    twitch: {
      accounts: {
        channel1: {
          username: "openclaw",
          accessToken: "oauth:abc123...",
          clientId: "xyz789...",
          channel: "vevisk",
        },
        channel2: {
          username: "openclaw",
          accessToken: "oauth:def456...",
          clientId: "uvw012...",
          channel: "secondchannel",
        },
      },
    },
  },
}
```

**Lưu ý:** Mỗi tài khoản cần token riêng (một token cho mỗi kênh).

## Kiểm soát truy cập

### Hạn chế theo vai trò

```json5
{
  channels: {
    twitch: {
      accounts: {
        default: {
          allowedRoles: ["moderator", "vip"],
        },
      },
    },
  },
}
```

### Allowlist theo User ID (an toàn nhất)

```json5
{
  channels: {
    twitch: {
      accounts: {
        default: {
          allowFrom: ["123456789", "987654321"],
        },
      },
    },
  },
}
```

### Truy cập dựa trên vai trò (thay thế)

`allowFrom` là allowlist cứng. Khi được đặt, chỉ các user ID đó được phép.
Nếu bạn muốn truy cập dựa trên vai trò, hãy để `allowFrom` trống và cấu hình `allowedRoles` thay thế:

```json5
{
  channels: {
    twitch: {
      accounts: {
        default: {
          allowedRoles: ["moderator"],
        },
      },
    },
  },
}
```

### Tắt yêu cầu @mention

Theo mặc định, `requireMention` là `true`. Để tắt và phản hồi mọi tin nhắn:

```json5
{
  channels: {
    twitch: {
      accounts: {
        default: {
          requireMention: false,
        },
      },
    },
  },
}
```

## Xử lý sự cố

Trước tiên, chạy các lệnh chẩn đoán:

```bash
openclaw doctor
openclaw channels status --probe
```

### Bot không phản hồi tin nhắn

**Kiểm tra kiểm soát truy cập:** Đảm bảo user ID của bạn nằm trong `allowFrom`, hoặc tạm thời gỡ
`allowFrom` và đặt `allowedRoles: ["all"]` để thử nghiệm.

**Kiểm tra bot đã vào kênh:** Bot phải tham gia kênh được chỉ định trong `channel`.

### Sự cố token

**“Failed to connect” hoặc lỗi xác thực:**

- Xác minh `accessToken` là giá trị OAuth access token (thường bắt đầu với tiền tố `oauth:`)
- Kiểm tra token có các scope `chat:read` và `chat:write`
- Nếu dùng làm mới token, xác minh `clientSecret` và `refreshToken` đã được đặt

### Làm mới token không hoạt động

**Kiểm tra log cho các sự kiện làm mới:**

```
Using env token source for mybot
Access token refreshed for user 123456 (expires in 14400s)
```

Nếu bạn thấy “token refresh disabled (no refresh token)”:

- Đảm bảo đã cung cấp `clientSecret`
- Đảm bảo đã cung cấp `refreshToken`

## Config

**Cấu hình tài khoản:**

- `username` - Tên người dùng bot
- `accessToken` - OAuth access token với `chat:read` và `chat:write`
- `clientId` - Twitch Client ID (từ Token Generator hoặc ứng dụng của bạn)
- `channel` - Kênh cần tham gia (bắt buộc)
- `enabled` - Bật tài khoản này (mặc định: `true`)
- `clientSecret` - Tùy chọn: Cho làm mới token tự động
- `refreshToken` - Tùy chọn: Cho làm mới token tự động
- `expiresIn` - Thời hạn token tính bằng giây
- `obtainmentTimestamp` - Thời điểm lấy token
- `allowFrom` - Allowlist user ID
- `allowedRoles` - Kiểm soát truy cập theo vai trò (`"moderator" | "owner" | "vip" | "subscriber" | "all"`)
- `requireMention` - Yêu cầu @mention (mặc định: `true`)

**Tùy chọn provider:**

- `channels.twitch.enabled` - Bật/tắt khởi động kênh
- `channels.twitch.username` - Tên người dùng bot (cấu hình một tài khoản đơn giản)
- `channels.twitch.accessToken` - OAuth access token (cấu hình một tài khoản đơn giản)
- `channels.twitch.clientId` - Twitch Client ID (cấu hình một tài khoản đơn giản)
- `channels.twitch.channel` - Kênh cần tham gia (cấu hình một tài khoản đơn giản)
- `channels.twitch.accounts.<accountName>` - Cấu hình nhiều tài khoản (tất cả các trường tài khoản ở trên)

Ví dụ đầy đủ:

```json5
{
  channels: {
    twitch: {
      enabled: true,
      username: "openclaw",
      accessToken: "oauth:abc123...",
      clientId: "xyz789...",
      channel: "vevisk",
      clientSecret: "secret123...",
      refreshToken: "refresh456...",
      allowFrom: ["123456789"],
      allowedRoles: ["moderator", "vip"],
      accounts: {
        default: {
          username: "mybot",
          accessToken: "oauth:abc123...",
          clientId: "xyz789...",
          channel: "your_channel",
          enabled: true,
          clientSecret: "secret123...",
          refreshToken: "refresh456...",
          expiresIn: 14400,
          obtainmentTimestamp: 1706092800000,
          allowFrom: ["123456789", "987654321"],
          allowedRoles: ["moderator"],
        },
      },
    },
  },
}
```

## Hành động công cụ

Tác tử có thể gọi `twitch` với hành động:

- `send` - Gửi tin nhắn tới một kênh

Ví dụ:

```json5
{
  action: "twitch",
  params: {
    message: "Hello Twitch!",
    to: "#mychannel",
  },
}
```

## An toàn & vận hành

- **Coi token như mật khẩu** – Không bao giờ commit token lên git
- **Dùng làm mới token tự động** cho các bot chạy lâu
- **Dùng allowlist theo user ID** thay vì username để kiểm soát truy cập
- **Theo dõi log** cho các sự kiện làm mới token và trạng thái kết nối
- **Giới hạn scope token** – Chỉ yêu cầu `chat:read` và `chat:write`
- **Nếu bị kẹt**: Khởi động lại Gateway sau khi xác nhận không có tiến trình nào khác đang sở hữu phiên

## Giới hạn

- **500 ký tự** mỗi tin nhắn (tự động chia nhỏ theo ranh giới từ)
- Markdown sẽ bị loại bỏ trước khi chia nhỏ
- Không giới hạn tốc độ (dùng giới hạn tích hợp sẵn của Twitch)
