{
  "internalAllowlistSource": "(?:10\\\\.|127\\\\.|::1$|localhost$|(?:[\\\\w.-]+\\\\.)?(?:local|internal|intra)$)",
  "common": {
    "hasHttp": { "pattern": "\\\\bhttps?:\\\\/\\\\/", "flags": "i" },
    "urlHost": { "pattern": "\\\\bhttps?:\\\\/\\\\/([^\\\\s\\\\/:]+)(?::\\\\d+)?", "flags": "gi" },
    "ftpSftpUrlHost": {
      "pattern": "\\\\b(?:sftp|ftp|ftps):\\\\/\\\\/([^\\\\s\\\\/:]+)(?::\\\\d+)?",
      "flags": "gi"
    },
    "bareHost": {
      "pattern": "(?<![@\\\\/\\\\\\\\])\\\\b((?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|localhost|[a-z0-9][a-z0-9.-]+\\\\.[a-z]{2,})(?::\\\\d+)?\\\\b",
      "flags": "gi"
    },
    "remoteHostColon": {
      "pattern": "(?:^|\\\\s)(?:[\\\\w.-]+@)?((?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|localhost|[a-z0-9][a-z0-9.-]+\\\\.[a-z]{2,})(?=:[^\\\\s])",
      "flags": "gi"
    },
    "scpUserAtHost": {
      "pattern": "\\\\b[\\\\w.-]+@((?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|localhost|[a-z0-9][a-z0-9.-]+\\\\.[a-z]{2,})\\\\b",
      "flags": "gi"
    },
    "curlExfil": {
      "pattern": "\\\\bcurl\\\\b[^\\\\n]*(?:\\\\s(?:-d\\\\b|--data(?:-raw|-binary|-urlencode)?\\\\b|--json\\\\b|-F\\\\b|--form\\\\b|-T\\\\b|--upload-file\\\\b))",
      "flags": "i"
    },
    "wgetExfil": {
      "pattern": "\\\\bwget\\\\b[^\\\\n]*(?:(?:--post-data\\\\b|--post-file\\\\b|--body-data\\\\b|--body-file\\\\b))",
      "flags": "i"
    },
    "sftpForbidden": { "pattern": "\\\\bsftp(?:\\\\.exe)?\\\\b", "flags": "i" },
    "lftpForbidden": { "pattern": "\\\\blftp\\\\b", "flags": "i" },
    "ftpForbidden": { "pattern": "\\\\bftp(?:\\\\.exe)?\\\\b", "flags": "i" },
    "ftpSftpHostArg": {
      "pattern": "\\\\b(?:sftp|ftp)(?:\\\\.exe)?\\\\b(?:\\\\s+(?:-\\\\S+|--\\\\S+))*\\\\s+(?:[\\\\w.-]+@)?((?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|localhost|[a-z0-9][a-z0-9.-]+\\\\.[a-z]{2,})(?=\\\\s|$)",
      "flags": "gi"
    },
    "transferUpload": {
      "pattern": "\\\\b(?:scp|rsync)\\\\b(?:\\\\s+(?:-P\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-i\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-o\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-F\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-S\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-J\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-e\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|--port\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|--rsh\\\\s+(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)|-\\\\S+|--\\\\S+))*\\\\s+(?!(?:[\\\\w.-]+@)?(?![a-zA-Z]:[\\\\/\\\\\\\\])[\\\\w.-]+:)(?:\\\"[^\\\"]+\\\"|'[^']+'|\\\\S+)\\\\s+(?:[\\\\w.-]+@)?[\\\\w.-]+:/",
      "flags": "i"
    }
  },
  "linux": {
    "exfilPlatformIndicator": { "pattern": ">\\\\s*\\\\/dev\\\\/(?:tcp|udp)\\\\/", "flags": "i" },
    "devTcpHost": {
      "pattern": "\\\\/(?:dev)\\\\/(?:tcp|udp)\\\\/((?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|localhost|[a-z0-9][a-z0-9.-]+\\\\.[a-z]{2,})\\\\/\\\\d+\\\\b",
      "flags": "gi"
    }
  },
  "windows": {
    "exfilPlatformIndicator": {
      "pattern": "(?:\\\\b(?:powershell|pwsh)?\\\\b[^\\\\n]*\\\\b(?:invoke-webrequest|invoke-restmethod|iwr|irm)\\\\b[^\\\\n]*(?:-(?:body|infile|form)\\\\b|-method\\\\s+(?:post|put|patch)\\\\b)|\\\\bstart-bitstransfer\\\\b[^\\\\n]*-transfertype\\\\s+upload\\\\b|\\\\bbitsadmin\\\\b[^\\\\n]*\\\\/upload\\\\b|\\\\bsystem\\\\.net\\\\.webclient\\\\b[^\\\\n]*\\\\bupload(?:file|string|data)\\\\b)",
      "flags": "i"
    }
  }
}
