# flipflop-travel å‡ç´šè¦æ ¼æ›¸

**å»ºç«‹æ™‚é–“**ï¼š2026-02-05 11:43 UTC  
**æœ€å¾Œæ›´æ–°**ï¼š2026-02-05 12:08 UTC  
**éœ€æ±‚ä¾†æº**ï¼šMimiï¼ˆå§å§ï¼‰  
**å¯©æ‰¹ç‹€æ…‹**ï¼šå¾… Cruz æ‰¹å‡†  
**é ä¼°å·¥æ™‚**ï¼š4-5 å°æ™‚ï¼ˆå«å…¨éƒ¨éœ€æ±‚ï¼‰

---

## éœ€æ±‚æ‘˜è¦

Mimi åœ¨ä½¿ç”¨ flipflop-travel ç®¡ç†æ—…è¡Œåœ˜æ™‚ï¼Œæå‡ºä»¥ä¸‹éœ€æ±‚ï¼š

| # | éœ€æ±‚ | å„ªå…ˆç´š | ç—›é» |
|---|------|--------|------|
| 1 | **æ‰¹æ¬¡å¥—ç”¨è²»ç”¨** | ğŸ”´ æœ€é«˜ | ã€Œæœ€éº»ç…©å°±æ˜¯ä¸€å€‹ä¸€å€‹å¡«ã€ |
| 2 | æ–°å¢ã€Œç°½è­‰ã€æ¬„ä½ | ğŸŸ¡ é«˜ | å¸¸ç”¨è²»ç”¨é …ç›® |
| 3 | æ–°å¢ã€Œç¥¨åˆ¸ã€æ¬„ä½ | ğŸŸ¡ é«˜ | é–€ç¥¨/æ¨‚åœ’ç¥¨/JR Pass ç­‰ |
| 4 | æ—…è¡Œåœ˜æŒ‰æ—¥æœŸæ’åº | ğŸŸ¢ ä¸­ | å¿«åˆ°çš„æ’å‰é¢ |
| 5 | è¡Œç¨‹è¡¨åˆ†äº«å„ªåŒ– | ğŸŸ¢ ä¸­ | ç›®å‰è¦æ‰‹å‹•ä¸Ÿé€£çµé€² LINE |

**åœ˜è¦æ¨¡**ï¼š5-15 äºº/åœ˜

---

## ç”¢å“è¦æ ¼ï¼ˆçµ¦ Mimiï¼‰

### â‘  è²»ç”¨æ˜ç´°æ–°å¢å…©é …

| ç¾æœ‰é …ç›® | æ–°å¢é …ç›® |
|----------|----------|
| âœˆï¸ æ©Ÿç¥¨ | ğŸ›‚ **ç°½è­‰** |
| ğŸ¨ ä½å®¿ | ğŸ« **ç¥¨åˆ¸** |
| ğŸš åŒ…è»Š | |
| ğŸ“± ç¶²å¡ | |

### â‘¡ æ–°åŠŸèƒ½ï¼šä¸€éµå¥—ç”¨é è¨­é‡‘é¡

**å…¥å£**ï¼šåœ˜å‹™ç®¡ç†é é¢æ–°å¢ã€ŒğŸ“ è¨­å®šé è¨­è²»ç”¨ã€æŒ‰éˆ•

**ä½¿ç”¨æµç¨‹**ï¼š
1. é»ã€Œè¨­å®šé è¨­è²»ç”¨ã€
2. å¡«å…¥é€™åœ˜çš„æ¨™æº–é‡‘é¡ï¼ˆæ©Ÿç¥¨/ä½å®¿/åŒ…è»Š/ç¶²å¡/ç°½è­‰/ç¥¨åˆ¸ï¼‰
3. æŒ‰ã€Œå¥—ç”¨åˆ°å…¨éƒ¨åœ˜å“¡ã€
4. å…¨éƒ¨äººè‡ªå‹•å¸¶å…¥
5. ç‰¹æ®Šçš„ï¼ˆå°å­©ã€ä¸åŒæ–¹æ¡ˆï¼‰å†å€‹åˆ¥é»é€²å»æ”¹

**åƒ¹å€¼**ï¼š20 äººçš„åœ˜å¾ã€Œé» 20 æ¬¡ã€å¡« 20 æ¬¡ã€â†’ã€Œå¡« 1 æ¬¡ã€é» 1 ä¸‹ã€

---

## æŠ€è¡“è¦æ ¼ï¼ˆçµ¦ Cruzï¼‰

### å°ˆæ¡ˆè³‡è¨Š
- **Repo è·¯å¾‘**ï¼š`/home/node/Documents/flipflop-travel`
- **éƒ¨ç½²ä½ç½®**ï¼š`flipflop-travel-rosy.vercel.app`
- **æŠ€è¡“æ£§**ï¼šReact 19 + Vite + Vercel Serverless + PostgreSQL (Neon)

### è³‡æ–™åº« Migration

```sql
-- æ–°å¢ç°½è­‰å’Œç¥¨åˆ¸æ¬„ä½
ALTER TABLE members 
  ADD COLUMN visa_amount INTEGER DEFAULT 0,
  ADD COLUMN voucher_amount INTEGER DEFAULT 0;
```

**åŸ·è¡Œæ–¹å¼**ï¼š
- è·¯ç·š Aï¼ˆå»ºè­°ï¼‰ï¼š`psql "$POSTGRES_URL" -c "ALTER TABLE ..."`
- è·¯ç·š Bï¼šNeon Console æ‰‹å‹•åŸ·è¡Œ

### å¾Œç«¯ API ä¿®æ”¹

#### 1. `api/members/update.js`ï¼ˆPUTï¼‰
- request body æ–°å¢ï¼š`visaAmount`, `voucherAmount`
- ç¸½é¡è¨ˆç®—ï¼šåŠ å…¥ visa + voucher
- SQL UPDATEï¼šåŠ å…¥ `visa_amount`, `voucher_amount`
- responseï¼šå›å‚³æ–°æ¬„ä½

#### 2. `api/members/list.js`ï¼ˆGETï¼‰
- SELECT å¤šæ’ˆï¼š`m.visa_amount`, `m.voucher_amount`
- å›å‚³ members åŠ å…¥ï¼š`visaAmount`, `voucherAmount`
- `calculatedTotal` è¨ˆç®—ç´å…¥æ–°æ¬„ä½

#### 3. `api/members/my_status.js`ï¼ˆGETï¼‰
- SELECT å¤šæ’ˆæ–°æ¬„ä½
- categories é™£åˆ—æ–°å¢ï¼š
  - `{ name: 'ç°½è­‰', emoji: 'ğŸ›‚', amount, status }`
  - `{ name: 'ç¥¨åˆ¸', emoji: 'ğŸ«', amount, status }`
- æ‰£æ¬¾é †åºå»ºè­°ï¼šæ©Ÿç¥¨ > ç°½è­‰ > ä½å®¿ > åŒ…è»Š > ç¥¨åˆ¸ > ç¶²å¡

### å¾Œç«¯ API æ–°å¢

#### `api/members/batch_update.js`ï¼ˆPOSTï¼‰

**Request Body**ï¼š
```json
{
  "tripId": "uuid",
  "flightAmount": 15000,
  "hotelAmount": 7250,
  "transportAmount": 930,
  "simcardAmount": 144,
  "visaAmount": 1200,
  "voucherAmount": 800
}
```

**è¡Œç‚º**ï¼š
- é©—è­‰ admin æ¬Šé™
- UPDATE è©² tripId ä¸‹æ‰€æœ‰ members çš„è²»ç”¨æ¬„ä½
- ä¸å‹• `paid_amount` / `status`ï¼ˆé¿å…è¦†è“‹å·²ç¹³è²»ç‹€æ…‹ï¼‰
- å›å‚³æ›´æ–°ç­†æ•¸

**SQL ç¯„ä¾‹**ï¼š
```sql
UPDATE members 
SET 
  flight_amount = $1,
  hotel_amount = $2,
  transport_amount = $3,
  simcard_amount = $4,
  visa_amount = $5,
  voucher_amount = $6,
  total_amount = $1 + $2 + $3 + $4 + $5 + $6,
  updated_at = CURRENT_TIMESTAMP
WHERE trip_id = $7
```

### å‰ç«¯ä¿®æ”¹

#### 1. `src/components/members/EditMemberForm.jsx`
- state æ–°å¢ï¼š`visaAmount`, `voucherAmount`
- UI æ–°å¢å…©å€‹è¼¸å…¥æ¡†ï¼ˆğŸ›‚ ç°½è­‰ã€ğŸ« ç¥¨åˆ¸ï¼‰
- ç¸½é¡è¨ˆç®—åŠ å…¥æ–°æ¬„ä½

#### 2. `src/components/members/MemberCard.jsx`
- é¡¯ç¤ºæ–°æ¬„ä½ï¼ˆå¦‚æœ‰é¡¯ç¤ºè²»ç”¨æ˜ç´°ï¼‰

#### 3. `src/pages/TripManagePage.jsx`
- æ–°å¢ã€ŒğŸ“ è¨­å®šé è¨­è²»ç”¨ã€æŒ‰éˆ•
- å¼•å…¥ BatchFeeForm Modal

#### 4. æ–°å¢ `src/components/members/BatchFeeForm.jsx`
- é è¨­è²»ç”¨è¡¨å–®å…ƒä»¶
- 6 å€‹è²»ç”¨è¼¸å…¥æ¡†
- ã€Œå¥—ç”¨åˆ°å…¨éƒ¨åœ˜å“¡ã€æŒ‰éˆ•
- å‘¼å« `api/members/batch_update`

### éƒ¨ç½²æµç¨‹

1. **DB Migration**ï¼šåŸ·è¡Œ ALTER TABLE
2. **ç¨‹å¼ç¢¼ä¿®æ”¹**ï¼šå‰å¾Œç«¯æ”¹å‹•
3. **Git Push**ï¼šè§¸ç™¼ Vercel è‡ªå‹•éƒ¨ç½²
4. **é©—æ”¶æ¸¬è©¦**ï¼š
   - å»ºæ¸¬è©¦åœ˜
   - æ‰¹æ¬¡å¥—ç”¨é è¨­è²»ç”¨
   - ç¢ºèªæ•¸å­—æ­£ç¢º
   - å€‹åˆ¥ç·¨è¼¯ç¢ºèªæ–°æ¬„ä½å¯ç”¨

---

## é©—æ”¶æ¸…å–®

- [ ] DB schema æœ‰ `visa_amount`, `voucher_amount` æ¬„ä½
- [ ] Admin ç·¨è¼¯åœ˜å“¡ï¼šå¯å¡«ç°½è­‰/ç¥¨åˆ¸é‡‘é¡ï¼Œç¸½é¡æ­£ç¢º
- [ ] Admin æ‰¹æ¬¡å¥—ç”¨ï¼šä¸€éµæ›´æ–°å…¨éƒ¨åœ˜å“¡è²»ç”¨
- [ ] åœ˜å“¡ç«¯ my_statusï¼šcategories æ­£ç¢ºé¡¯ç¤ºæ–°é …ç›®
- [ ] ä¸å½±éŸ¿ç¾æœ‰è³‡æ–™ï¼ˆå·²ç¹³é‡‘é¡ã€ç‹€æ…‹ä¸è¢«è¦†è“‹ï¼‰

---

## éœ€æ±‚ â‘¢ï¼šæ—…è¡Œåœ˜ä¾é–‹åœ˜æ—¥æœŸæ’åº

**éœ€æ±‚ä¾†æº**ï¼šMimiï¼ˆ2026-02-05 è¿½åŠ ï¼‰

### ç”¢å“èªªæ˜
æ—…è¡Œåœ˜åˆ—è¡¨æ”¹ç‚ºæŒ‰ã€Œå‡ºç™¼æ—¥æœŸã€æ’åºï¼Œ**æœ€è¿‘è¦å‡ºç™¼çš„æ’æœ€ä¸Šé¢**ã€‚

æ”¹å®Œå¾Œçœ‹åˆ°çš„é †åºï¼š
```
ğŸ”œ 2/15 æ—¥æœ¬åœ˜ â† æœ€è¿‘çš„
ğŸ“… 3/01 éŸ“åœ‹åœ˜
ğŸ“… 4/10 æ³°åœ‹åœ˜
```

### æŠ€è¡“è¦æ ¼

**å½±éŸ¿æª”æ¡ˆ**ï¼š
- `api/trips/list.js`ï¼ˆAdminï¼‰
- `api/trips/my_list.js`ï¼ˆåœ˜å“¡ï¼‰

**SQL æ”¹å‹•**ï¼š
```sql
-- å»ºè­°ï¼šæœªå‡ºç™¼çš„æŒ‰æ—¥æœŸå‡å†ªï¼Œå·²çµæŸçš„æ’æœ€å¾Œ
ORDER BY 
  CASE WHEN start_date < CURRENT_DATE THEN 1 ELSE 0 END,
  start_date ASC
```

---

## éœ€æ±‚ â‘£ï¼šè¡Œç¨‹è¡¨åˆ†äº«å„ªåŒ–

**éœ€æ±‚ä¾†æº**ï¼šMimiï¼ˆ2026-02-05 è¿½åŠ ï¼‰

### ç”¢å“èªªæ˜
ç›®å‰ Mimi è¦åˆ†äº«è¡Œç¨‹è¡¨çµ¦åœ˜å“¡ï¼Œéœ€è¦ï¼š
1. æ‰‹å‹•è¤‡è£½é€£çµ
2. è²¼åˆ° LINE ç¾¤çµ„

**å„ªåŒ–æ–¹æ¡ˆ**ï¼š
- åœ¨ã€Œåœ˜å‹™ç®¡ç†ã€é é¢åŠ ä¸€å€‹ã€ŒğŸ“¤ åˆ†äº«è¡Œç¨‹ã€æŒ‰éˆ•
- é»æ“Šå¾Œç”¢ç”Ÿè©²åœ˜å°ˆå±¬çŸ­é€£çµ + è¤‡è£½åˆ°å‰ªè²¼ç°¿
- æˆ–ç›´æ¥è§¸ç™¼ LINE åˆ†äº«ï¼ˆå¦‚æœ LIFF æ”¯æ´ï¼‰

### æŠ€è¡“è¦æ ¼

**æ–¹æ¡ˆ Aï¼ˆç°¡å–®ç‰ˆï¼‰**ï¼š
- å‰ç«¯åŠ ã€Œè¤‡è£½é€£çµã€æŒ‰éˆ•
- é€£çµæ ¼å¼ï¼š`https://flipflop-travel-rosy.vercel.app/?tripId=xxx&view=itinerary`
- ä½¿ç”¨ `navigator.clipboard.writeText()` è¤‡è£½

**æ–¹æ¡ˆ Bï¼ˆé€²éšç‰ˆï¼‰**ï¼š
- ä½¿ç”¨ LIFF `liff.shareTargetPicker()` ç›´æ¥åˆ†äº«åˆ° LINE èŠå¤©
- éœ€è¦åœ¨ LINE Developers Console é–‹å•Ÿç›¸é—œæ¬Šé™

**å»ºè­°**ï¼šå…ˆåšæ–¹æ¡ˆ Aï¼Œç°¡å–®æœ‰æ•ˆ

---

## å¾…ç¢ºèªäº‹é …

- [ ] Vercel å°ˆæ¡ˆæ¬Šé™ï¼ˆCruz æœƒæä¾›ï¼‰
- [ ] æ‰£æ¬¾å„ªå…ˆé †åºç¢ºèªï¼ˆç°½è­‰æ’åœ¨å“ªï¼Ÿï¼‰
- [ ] æ˜¯å¦éœ€è¦ã€Œé¸æ“‡æ€§å¥—ç”¨ã€ï¼ˆä¾‹å¦‚åªå¥—ç”¨ä½å®¿ï¼Œä¸å¥—ç”¨æ©Ÿç¥¨ï¼‰
- [ ] å·²çµæŸçš„åœ˜è¦æ’æœ€å¾Œé‚„æ˜¯å®Œå…¨éš±è—ï¼Ÿ
- [ ] è¡Œç¨‹åˆ†äº«ï¼šç”¨ã€Œè¤‡è£½é€£çµã€é‚„æ˜¯ã€ŒLIFF åˆ†äº«ã€ï¼Ÿ

---

## å®Œæ•´æ”¹å‹•æ¸…å–®

### è³‡æ–™åº«
- [ ] `members` è¡¨æ–°å¢ `visa_amount` æ¬„ä½
- [ ] `members` è¡¨æ–°å¢ `voucher_amount` æ¬„ä½

### å¾Œç«¯ API
- [ ] `api/members/update.js` - æ”¯æ´æ–°æ¬„ä½
- [ ] `api/members/list.js` - å›å‚³æ–°æ¬„ä½
- [ ] `api/members/my_status.js` - categories åŠ æ–°é …ç›®
- [ ] `api/members/batch_update.js` - **æ–°å¢**æ‰¹æ¬¡æ›´æ–° API
- [ ] `api/trips/list.js` - æŒ‰ start_date æ’åº
- [ ] `api/trips/my_list.js` - æŒ‰ start_date æ’åº

### å‰ç«¯
- [ ] `EditMemberForm.jsx` - åŠ ç°½è­‰/ç¥¨åˆ¸è¼¸å…¥æ¡†
- [ ] `MemberCard.jsx` - é¡¯ç¤ºæ–°æ¬„ä½
- [ ] `TripManagePage.jsx` - åŠ ã€Œè¨­å®šé è¨­è²»ç”¨ã€æŒ‰éˆ•
- [ ] `TripManagePage.jsx` - åŠ ã€Œåˆ†äº«è¡Œç¨‹ã€æŒ‰éˆ•
- [ ] `BatchFeeForm.jsx` - **æ–°å¢**æ‰¹æ¬¡è²»ç”¨è¡¨å–®å…ƒä»¶

---

*æ­¤è¦æ ¼ç”±ç„¡æ¥µæ•´ç†ï¼Œç­‰å¾… Cruz åœ¨å¦ä¸€å€‹ session æ‰¹å‡†å¾ŒåŸ·è¡Œã€‚*
