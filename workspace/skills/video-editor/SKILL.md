# Video Editor

å½±ç‰‡ç·¨è¼¯å·¥å…· â€” è‡ªå‹•å­—å¹•ç”Ÿæˆã€AI èªèª¿å°æ¼”ã€èªéŒ„å½±ç‰‡ç”Ÿæˆã€‚

## è§¸ç™¼è©

å­—å¹•ã€subtitleã€transcribeã€åŠ å­—å¹•ã€video editã€èªéŒ„å½±ç‰‡ã€TTS

## ç›®å‰ç­‰ç´šï¼šLv.3+ æ™ºèƒ½ç·¨è¼¯ï¼ˆé€²éšï¼‰

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### 1. å­—å¹•è‡ªå‹•ç”Ÿæˆ

- **èªéŸ³è½‰æ–‡å­—**ï¼šOpenAI Whisper API
- **æ™ºèƒ½æ–·å¥**ï¼šä¸­æ–‡å­—å¹•è¦å‰‡ï¼ˆé€—è™Ÿã€å¥è™Ÿã€èªæ„ï¼‰
- **æ ¼å¼è¼¸å‡º**ï¼šSRT å­—å¹•æª”
- **å½±ç‰‡ç‡’éŒ„**ï¼šè‡ªå‹•ç–ŠåŠ åˆ°å½±ç‰‡ï¼ˆffmpeg/PILï¼‰

#### 2. AI èªèª¿å°æ¼”

- **å¤šæä¾›å•† TTS**ï¼šFish Audio S1 â†’ edge-tts fallback
- **LLM èªèª¿æ§åˆ¶**ï¼šå‹•æ…‹èªé€Ÿã€åœé “ã€é‡éŸ³
- **SSML é¢¨æ ¼æ¨™è¨»**ï¼šå°ˆæ¥­èªéŸ³å°æ¼”è¼¸å‡º
- **æˆæœ¬å„ªåŒ–**ï¼šå…è²»å‚™é¸æ–¹æ¡ˆ

#### 3. èªéŒ„å½±ç‰‡ç”Ÿæˆ

- **è±å±æ ¼å¼**ï¼š9:16 (1080Ã—1920) æ”¯æ´ Shorts/Reels/TikTok
- **æ‰“å­—æ©Ÿæ•ˆæœ**ï¼šæ–‡å­—é€å­—å‡ºç¾å‹•ç•«
- **èƒŒæ™¯åœ–åƒ**ï¼šæ¨¡ç³Šè™•ç†æˆ–æ¼¸å±¤èƒŒæ™¯
- **TTS æ—ç™½**ï¼šè‡ªå‹•ç”ŸæˆèªéŸ³

## ä½¿ç”¨æ–¹å¼

### å­—å¹•ç”Ÿæˆ

```bash
# å®Œæ•´æµç¨‹ï¼šå½±ç‰‡ â†’ å­—å¹• â†’ ç‡’éŒ„
python3 scripts/subtitle_gen.py --input video.mp4 --language zh

# åªç”Ÿæˆ SRT å­—å¹•æª”
python3 scripts/subtitle_gen.py --input audio.mp3 --srt-only

# æŒ‡å®šè¼¸å‡ºè·¯å¾‘
python3 scripts/subtitle_gen.py --input video.mp4 --output result.mp4

# è‡ªå‹•æ¸¬è©¦
python3 scripts/subtitle_gen.py --test
```

### èªéŒ„å½±ç‰‡ç”Ÿæˆ

```bash
# å‰µå»ºèªéŒ„å½±ç‰‡
python3 scripts/quote_video.py --text "ä½ çš„èªéŒ„æ–‡å­—" --bg background.jpg

# æ¸¬è©¦æ¨¡å¼ï¼ˆä½¿ç”¨é è¨­å…§å®¹ï¼‰
python3 scripts/quote_video.py --test

# è‡ªå®šç¾©èƒŒæ™¯
python3 scripts/quote_video.py --test --bg ~/Downloads/photo.jpg
```

### AI èªèª¿å°æ¼”

```python
# åœ¨ä»£ç¢¼ä¸­ä½¿ç”¨
from prosody_director import generate_directed_audio

audio_path = generate_directed_audio(
    text="ä½ çš„æ–‡å­—",
    provider="fish_audio",  # fish_audio æˆ– edge_tts
    voice="S1"  # Fish Audio S1 æˆ– edge-tts è²éŸ³
)
```

## ä¾è³´

| å·¥å…·              | ç”¨é€”              | å®‰è£                   |
| ----------------- | ----------------- | ---------------------- |
| python3 (3.10+)   | åŸ·è¡Œè…³æœ¬          | ç³»çµ±è‡ªå¸¶               |
| ffmpeg            | éŸ³é »æå–/å½±ç‰‡åˆæˆ | `brew install ffmpeg`  |
| openai (Python)   | Whisper API       | `pip install openai`   |
| Pillow            | åœ–ç‰‡è™•ç†          | `pip install Pillow`   |
| edge-tts (Python) | å…è²» TTS          | `pip install edge-tts` |

**ç’°å¢ƒè®Šæ•¸ï¼š**

- `OPENAI_API_KEY` â€” OpenAI API é‡‘é‘°ï¼ˆå¿…éœ€ï¼‰
- `FISH_AUDIO_API_KEY` â€” Fish Audio API é‡‘é‘°ï¼ˆé¸ç”¨ï¼‰

## æŠ€è¡“ç´°ç¯€

### å­—å¹•ç”Ÿæˆ

- **è½‰è­¯å¼•æ“**ï¼šOpenAI Whisper API (`whisper-1`, `verbose_json`)
- **å­—å¹•ç‡’éŒ„**ï¼šè‡ªå‹•åµæ¸¬ ffmpeg èƒ½åŠ›
  - æœ‰ libass â†’ `subtitles` filterï¼ˆå¿«é€Ÿï¼‰
  - ç„¡ libass â†’ PIL overlay fallbackï¼ˆé€šç”¨ï¼‰
- **æˆæœ¬**ï¼š~$0.006/åˆ†é˜ï¼ˆWhisper APIï¼‰

### AI èªèª¿å°æ¼”

- **æä¾›å•†å„ªå…ˆç´š**ï¼šFish Audio S1 â†’ edge-ttsï¼ˆfallbackï¼‰
- **LLM æç¤ºå·¥ç¨‹**ï¼šSSML é¢¨æ ¼èªé€Ÿ/åœé “æ§åˆ¶
- **èªé€Ÿç¯„åœ**ï¼š-30% åˆ° +20%
- **åœé “é¡å‹**ï¼šå¾®åœé “ (150-250ms)ã€å‘¼å¸åœé “ (400-600ms)ã€æˆ²åŠ‡æ€§åœé “ (800-1200ms)

### èªéŒ„å½±ç‰‡

- **è§£æåº¦**ï¼š1080Ã—1920 (9:16)
- **æ–‡å­—æ’ç‰ˆ**ï¼šæ¯è¡Œæœ€å¤š 7 ä¸­æ–‡å­—ç¬¦
- **å‹•ç•«æ™‚æ©Ÿ**ï¼šæ ¹æ“šèªéŸ³ç¯€å¥åŒæ­¥
- **èƒŒæ™¯è™•ç†**ï¼šé«˜æ–¯æ¨¡ç³Š + äº®åº¦èª¿æ•´

## è·¯ç·šåœ–

| ç­‰ç´š     | åç¨±         | ç‹€æ…‹          |
| -------- | ------------ | ------------- |
| Lv.2     | åŸºç¤è‡ªå‹•åŒ–   | è¦åŠƒä¸­        |
| **Lv.3** | **æ™ºèƒ½ç·¨è¼¯** | **âœ… å·²å¯¦ç¾** |
| Lv.4     | å¤šæ¨¡æ…‹ç”Ÿæˆ   | é€²è¡Œä¸­        |
| Lv.5     | å…¨è‡ªå‹•å·¥ä½œæµ | è¦åŠƒä¸­        |
| Lv.6     | ç”Ÿæ…‹ç³»çµ±     | è¦åŠƒä¸­        |

**å‡ç´šè¦åŠƒ**ï¼š`docs/upgrade-roadmap.md`
**Lv.6 å®Œæ•´è¦æ ¼**ï¼š`docs/lv6-product-spec.md`ï¼ˆ26KBï¼Œå¯äº¤ä»˜é–‹ç™¼åœ˜éšŠï¼‰

## æ–‡ä»¶çµæ§‹

```
video-editor/
â”œâ”€â”€ SKILL.md                    # æœ¬æ–‡ä»¶
â”œâ”€â”€ docs/                       # æ–‡æª”
â”‚   â”œâ”€â”€ upgrade-roadmap.md      # å‡ç´šè·¯ç·šåœ–
â”‚   â””â”€â”€ lv6-product-spec.md     # Lv.6 å®Œæ•´è¦æ ¼
â”œâ”€â”€ scripts/                    # è…³æœ¬
â”‚   â”œâ”€â”€ subtitle_gen.py         # å­—å¹•ç”Ÿæˆä¸»è…³æœ¬
â”‚   â”œâ”€â”€ prosody_director.py     # AI èªèª¿å°æ¼”
â”‚   â”œâ”€â”€ quote_video.py          # èªéŒ„å½±ç‰‡ç”Ÿæˆ
â”‚   â”œâ”€â”€ subtitle_rules.py       # å­—å¹•æ–·å¥è¦å‰‡
â”‚   â””â”€â”€ srt_utils.py            # SRT æ ¼å¼å·¥å…·
â””â”€â”€ output/                     # è¼¸å‡ºç›®éŒ„ï¼ˆæ¸¬è©¦æ–‡ä»¶ï¼‰
```

## æ¸¬è©¦è¼¸å‡º

æ¸¬è©¦æ–‡ä»¶ä½æ–¼ `output/` ç›®éŒ„ï¼š

- `test.srt` - è‡ªå‹•ç”Ÿæˆå­—å¹•
- `test_with_subs.mp4` - ç‡’éŒ„å­—å¹•å½±ç‰‡
- `quote_test.mp4` - èªéŒ„å½±ç‰‡æ¸¬è©¦
- `normal_test.mp3` - TTS æ¸¬è©¦
- `rap_test.mp3` - èªé€Ÿæ¸¬è©¦

---

_æœ€å¾Œæ›´æ–°ï¼š2026-02-06_
_ç‰ˆæœ¬ï¼šv3.0_
